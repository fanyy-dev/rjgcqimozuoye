"use strict";(self["webpackChunkvue_template"]=self["webpackChunkvue_template"]||[]).push([[80],{139:function(e,t,a){a.r(t),a.d(t,{default:function(){return m}});a(560);var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"app-container"},[t("el-card",{staticClass:"box-table"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.searchForm}},[t("el-form-item",{attrs:{label:"备注"}},[t("el-input",{attrs:{placeholder:"请输入备注",clearable:""},model:{value:e.searchForm.remark,callback:function(t){e.$set(e.searchForm,"remark",t)},expression:"searchForm.remark"}})],1),t("el-form-item",{attrs:{label:"状态"}},[t("el-select",{attrs:{clearable:""},model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}},[t("el-option",{attrs:{label:"已预订",value:1}}),t("el-option",{attrs:{label:"已入住",value:2}}),t("el-option",{attrs:{label:"已退房",value:3}})],1)],1),t("el-form-item",{attrs:{label:"用户"}},[t("el-select",{attrs:{placeholder:"请选择",clearable:"",filterable:""},model:{value:e.searchForm.memberId,callback:function(t){e.$set(e.searchForm,"memberId",t)},expression:"searchForm.memberId"}},e._l(e.memberList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name+"-"+e.idcard,value:e.id}})})),1)],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("查询")]),t("el-button",{attrs:{type:"success"},on:{click:function(t){return e.$router.push("/admin/addOrders")}}},[e._v("新增入住")])],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":"",size:"small"}},[t("el-table-column",{attrs:{align:"center",label:"ID",prop:"id"}}),t("el-table-column",{attrs:{align:"center",label:"用户",prop:"member.name"}}),t("el-table-column",{attrs:{align:"center",label:"电话",prop:"member.phone"}}),t("el-table-column",{attrs:{align:"center",label:"身份证",prop:"member.idcard","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{align:"center",label:"性别",prop:"member.gender"},scopedSlots:e._u([{key:"default",fn:function(a){return[1==a.row.member.gender?t("el-tag",{attrs:{type:"success"}},[e._v("男")]):e._e(),2==a.row.member.gender?t("el-tag",{attrs:{type:"danger"}},[e._v("女")]):e._e()]}}])}),t("el-table-column",{attrs:{align:"center",label:"房型",prop:"room.category.categoryName"}}),t("el-table-column",{attrs:{align:"center",label:"房号",prop:"room.roomNum"}}),t("el-table-column",{attrs:{align:"center",label:"入住时间",prop:"startTime"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.startTime.slice(0,10))+" ")]}}])}),t("el-table-column",{attrs:{align:"center",label:"居住天数",prop:"days"}}),t("el-table-column",{attrs:{align:"center",label:"状态",prop:"status"},scopedSlots:e._u([{key:"default",fn:function(a){return[1==a.row.status?t("el-tag",{attrs:{type:"warning"}},[e._v("已预订")]):e._e(),2==a.row.status?t("el-tag",{attrs:{type:"success"}},[e._v("已入住")]):e._e(),3==a.row.status?t("el-tag",{attrs:{type:"danger"}},[e._v("已退房")]):e._e()]}}])}),t("el-table-column",{attrs:{align:"center",label:"备注",prop:"remark","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{align:"center",label:"实付金额",prop:"money"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" ￥"+e._s(t.row.money*t.row.days)+" ")]}}])}),t("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[1==a.row.status?t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.confirmOrder(a.row)}}},[e._v("确认入住")]):e._e(),3!=a.row.status?t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.checkOutOrder(a.row)}}},[e._v("退房")]):e._e(),t("el-popconfirm",{attrs:{title:"确定删除吗？"},on:{confirm:function(t){return e.deleteCofirm(a.row)}}},[t("el-button",{attrs:{slot:"reference",type:"text",size:"small"},slot:"reference"},[e._v("删除")])],1)]}}])})],1),t("el-pagination",{staticClass:"page-box",attrs:{background:"","current-page":e.pageNum,"page-sizes":[10,20],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("el-dialog",{attrs:{title:"退房",visible:e.showCheckOutDialog,"before-close":e.handleCheckOutDialogClose},on:{"update:visible":function(t){e.showCheckOutDialog=t}}},[t("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入备注(非必须)"},model:{value:e.checkoutDialogForm.remark,callback:function(t){e.$set(e.checkoutDialogForm,"remark",t)},expression:"checkoutDialogForm.remark"}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.showCheckOutDialog=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.checkOutDialogConfirm}},[e._v("确 定")])],1)],1)],1)},l=[],o=a(6502),s=a(8802),n={data(){return{list:null,listLoading:!0,pageSize:10,pageNum:1,total:0,searchForm:{},dialogTitle:"添加",dialogFormVisible:!1,dialogForm:{},memberList:[],checkoutDialogForm:{},showCheckOutDialog:!1}},async created(){this.fetchData();const e=await(0,s.bp)();this.memberList=e.data},methods:{handleSizeChange(e){this.pageSize=e,this.fetchData()},handleCurrentChange(e){this.pageNum=e,this.fetchData()},handleSearch(){this.fetchData()},async fetchData(){this.listLoading=!0;let e=await(0,o.WY)(this.pageNum,this.pageSize,this.searchForm);this.list=e.data.records,this.total=e.data.total,this.listLoading=!1},async deleteCofirm(e){this.pageNum=1;const t=await(0,o.L7)(e.id);this.$message({message:t.message,type:t.flag?"success":"error"}),this.fetchData()},confirmOrder(e){this.$confirm("确定入住吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const t=await(0,o.ls)(e.id);this.$message({message:t.message,type:t.flag?"success":"error"}),this.fetchData()})).catch((()=>{}))},handleCheckOutDialogClose(){this.showCheckOutDialog=!1,this.checkoutDialogForm.remark=""},checkOutOrder({id:e}){this.showCheckOutDialog=!0,this.checkoutDialogForm.id=e},async checkOutDialogConfirm(){const e=await(0,o.Rg)(this.checkoutDialogForm);this.$message({message:e.message,type:e.flag?"success":"error"}),e.flag&&(this.showCheckOutDialog=!1,this.fetchData())}}},i=n,c=a(1001),u=(0,c.Z)(i,r,l,!1,null,"c3b09f08",null),m=u.exports},8802:function(e,t,a){a.d(t,{EL:function(){return s},EU:function(){return n},K0:function(){return i},RJ:function(){return l},bp:function(){return o}});var r=a(60);const l=(e,t,a)=>(0,r.Z)({url:`/member/search/${e}/${t}`,method:"get",params:a}),o=()=>(0,r.Z)({url:"/member",method:"get"}),s=e=>(0,r.Z)({url:"/member",method:"post",data:e}),n=e=>(0,r.Z)({url:"/member",method:"put",data:e}),i=e=>(0,r.Z)({url:`/member/${e}`,method:"delete"})},6502:function(e,t,a){a.d(t,{L7:function(){return s},OO:function(){return o},Rg:function(){return i},WY:function(){return l},ls:function(){return n}});var r=a(60);const l=(e,t,a)=>(0,r.Z)({url:`/orders/search/${e}/${t}`,method:"get",params:a}),o=e=>(0,r.Z)({url:"/orders",method:"post",data:e}),s=e=>(0,r.Z)({url:`/orders/${e}`,method:"delete"}),n=e=>(0,r.Z)({url:`/orders/confirm/${e}`,method:"get"}),i=e=>(0,r.Z)({url:"/orders/checkOut",method:"get",params:e})}}]);
//# sourceMappingURL=Orders.cbe316b3.js.map